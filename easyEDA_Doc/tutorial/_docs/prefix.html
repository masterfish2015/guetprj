<!doctype html>
<html>
<head>

<style>

/*! ADAPTED
Typeplate : Starter Kit
URL ........... http://typeplate.com
Version ....... 3.0.2
Github ........ https://github.com/typeplate/starter-kit
Authors ....... Dennis Gaebel (@gryghostvisuals) & Zachary Kain (@zakkain)
License ....... Creative Commmons Attribution 3.0
License URL ... https://github.com/typeplate/starter-kit/blob/master/license.txt
*/

h1, h2, h3, h4, h5, h6 {
  text-rendering: optimizeLegibility;
  line-height: 1;
  margin-top: 0;
  color: #222;
}

blockquote + figcaption cite {
  display: block;
  font-size: inherit;
  text-align: right;
}

body {
  word-wrap: break-word;
}

pre code {
  word-wrap: normal;
}

body {
  -webkit-hyphens: auto;
  -ms-hyphens: auto;
  hyphens: auto;
  color: #444;
}

h1 { font-size: 2em;    /* 2*16 = 32 */       }
h2 { font-size: 1.5em;  /* 1.5*16 = 24 */     }
h3 { font-size: 1.17em; /* 1.17*16 = 18.72 */ }
h4 { font-size: 1em;    /* 1*16 = 16 */       }
h5 { font-size: 0.83em; /* 0.83*16 = 13.28 */ }
h6 { font-size: 0.75em; /* 0.75*16 = 12 */    }

h1 { margin: 2.42424rem 0 1.454544rem; }
h2 { margin: 2.0202rem 0 1.21212rem;  }
h3 { margin: 1.61616rem 0 1rem; }
h4 { margin: 1.21212rem 0 1; }
h5 { margin: 0.80808rem 0; }
h6 { margin: 0.70707rem 0; }

p { margin: auto auto 1.5rem; }

small {
  font-size: 65%;
}

input,
abbr,
acronym,
blockquote,
code,
kbd,
q,
samp,
var {
  -webkit-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

pre {
  white-space: pre;
}

pre code {
  white-space: -moz-pre-wrap;
  white-space: pre-wrap;
}

code {
  white-space: pre;
  font-family: SF Mono, Consolas, Dejavu Sans Mono, Menlo, monospace;
}

abbr {
  -webkit-font-variant: small-caps;
  -moz-font-variant: small-caps;
  -ms-font-variant: small-caps;
  font-variant: small-caps;
  font-weight: 600;
  text-transform: lowercase;
  color: gray;
}

abbr[title]:hover {
  cursor: help;
}

/* FROM http://purecss.io/layouts/side-menu/  adapted to remove pure classes*/
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  color: #444;
}

img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: auto;
}

code, pre {
  background-color: #f5f5f5;
  color: #444;
  border-radius: 2px;
  text-shadow: 0px 1px 0px white;
  box-shadow: 0 1px 1px rgba(0,0,0,0.15);
}
pre code {
  border: none;
  box-shadow: none;
}
pre {
  padding: 0.5em;
}
code {
  display: inline-block;
  padding: 0 0.5em;
  line-height: 1.4;
  font-size: 0.9em;
}

/*
Add transition to containers so they can push in and out.
 */
#layout,
#menu,
.menu-link {
  -webkit-transition: all 0.2s ease-out;
  -moz-transition: all 0.2s ease-out;
  -ms-transition: all 0.2s ease-out;
  -o-transition: all 0.2s ease-out;
  transition: all 0.2s ease-out;
}

/*
This is the parent `<div>` that contains the menu and the content area.
 */
#layout {
  position: relative;
  padding-left: 0;
}
#layout.active #menu {
  left: 250px;
  width: 250px;
}
#layout.active .menu-link {
  left: 250px;
}

/*
The content `<div>` is where all your content goes.
 */
.content {
  margin: 50px auto;
  padding: 0 2em;
  max-width: 80ex;
  line-height: 1.6em;
}

/*
The `#menu` `<div>` is the parent `<div>` that contains the menu that
appears on the left side of the page.
 */
#menu {
  margin-left: -250px; /* "#menu" width */
  width: 250px;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  z-index: 1000; /* so the menu or its navicon stays above all content */
  background: #f4f4f4;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  font-size: 0.9em;
}

/*
All anchors inside the menu should be styled like this.
 */
#menu a {
  display: block;
  text-decoration: none;
  color: #888;
  padding: 0.5em 0.5em;
}
#menu a:first-letter {
  text-transform: capitalize;
}

#menu ul {
  list-style-type: none;
  padding: 0;
  margin: 1em 0.5em;
}
#menu ul ul {
  margin-top: 0.5em;
  margin-left: 0.5em;
  border-left: 4px solid rgba(255,255,255,0.5);
}

/*
Change color of the anchor links on hover/focus.
 */
#menu li a:hover,
#menu li a:focus {
  background: rgba(255,255,255,0.4);
}

/*
This styles the selected menu item `<li>`.
 */
#menu li a.active {
  background: rgba(0,0,0,0.05);
}

/*
This styles a link within a selected menu item `<li>`.
 */
#menu li a.active {
  color: #222;
}

/*
This styles the menu heading.
 */
#menu li.heading {
  font-size: 0.9em;
  text-transform: uppercase;
  color: #000;
  margin: 1em 0.5em 0;
}

/* -- Dynamic Button For Responsive Menu -------------------------------------*/
/*
`.menu-link` represents the responsive menu toggle that shows/hides on
small screens.
 */
.menu-link {
  position: fixed;
  display: block; /* show this only on small screens */
  top: 0;
  left: 0; /* "#menu width" */
  background: #f4f4f4;
  font-size: 10px; /* change this value to increase/decrease button size */
  z-index: 10;
  width: 2em;
  height: auto;
  padding: 1.6em 1.2em;
}

.menu-link:hover {
  background: /*#f4f4f4 * 0.8*/#eee;
}

.menu-link span {
  position: relative;
  display: block;
}

.menu-link span,
.menu-link span:before,
.menu-link span:after {
  background-color: #fff;
  width: 100%;
  height: 0.2em;
}

.menu-link span:before,
.menu-link span:after {
  position: absolute;
  margin-top: -0.6em;
  content: " ";
}

.menu-link span:after {
  margin-top: 0.6em;
}

/*
Hides the menu at `48em`, but modify this based on your app's needs.
 */
@media (min-width: 48em) {

  .header,
  .content {
    padding-left: 2em;
    padding-right: 2em;
  }

  #layout {
    padding-left: 250px; /* left col width "#menu" */
    left: 0;
  }
  #menu {
    left: 250px;
  }

  .menu-link {
    position: fixed;
    left: 250px;
    display: none;
  }

  #layout.active .menu-link {
    left: 250px;
  }
}

@media (max-width: 48em) {
  /* Only apply this when the window is small. Otherwise, the following
  case results in extra padding on the left:
   * Make the window small.
   * Tap the menu to trigger the active state.
   * Make the window large again.
   */
  #layout.active {
    position: relative;
    left: 250px;
  }
}

</style>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">
</head>
<body>
<div id="layout">
  <!-- Menu toggle -->
  <a href="#menu" id="menuLink" class="menu-link">
    <!-- Hamburger icon -->
    <span></span>
  </a>
  <nav id="menu">
    <ul>
<li><a class="" href="README.html">README</a></li>
<li><a class="" href="index.html">index</a></li>
<li><a class="" href="API.html">API</a></li>
<li><a class="" href="PCB.html">PCB</a></li>
<li><a class="" href="PCBLib.html">PCBLib</a></li>
<li><a class="" href="PCBOrder.html">PCBOrder</a></li>
<li><a class="" href="PCBOrderFAQ.html">PCBOrderFAQ</a></li>
<li><a class="" href="Privacy.html">Privacy</a></li>
<li><a class="" href="Terms.html">Terms</a></li>
<li><a class="" href="convert.html">convert</a></li>
<li><a class="" href="creatingtheSchematicLibs.html">creatingtheSchematicLibs</a></li>
<li><a class="" href="export.html">export</a></li>
<li><a class="" href="import.html">import</a></li>
<li><a class="" href="introduction.html">introduction</a></li>
<li><a class="" href="new.html">new</a></li>
<li><a class="active" href="prefix.html">prefix</a></li>
<li><a class="" href="schematic.html">schematic</a></li>
<li><a class="" href="share.html">share</a></li>
<li><a class="" href="spiceSimulation.html">spiceSimulation</a></li>
</ul>
  </nav>
  <article id="main" class="content">
    <h1>Schematic symbols: prefixes and pin numbers</h1>
<p>Device and subcircuit (or hierarchical block) symbols created for use in schematics that are intended to be run as spice simulations, in addition to having a PCB Prefix that is used for the reference designator in the schematic, also have a <strong>Spice Prefix</strong>. They also have two sets of pin numbers: PCB pins and Spice pins.</p>
<h2>PCB and Spice Prefix</h2>
<p>The rules on the assignment of the PCB Prefix or reference designator of a schematic symbol are somewhat dependent on the EDA tool and on the user’s preferences. Depending on how a device is graphically represented by it’s schematic symbol it may have a different <strong>PCB Prefix</strong> or** reference designator**. For example, a single discrete MOSFET device may have a PCB Prefix of Q, M or perhaps TR, whereas if it is part of a monolithic multiple transistor array it may have a PCB Prefix of U or IC.</p>
<p>The rules on the assignment of the <strong>Spice Prefix</strong> of a schematic symbol are strict. This is because the Spice Prefix is used to tell the simulator which circuit element the symbol represents and therefore which simulation model it is to use.</p>
<p>Simulation models for most of the spice circuit elements are in the form of a single-line .model statement however some of them may be in the form of a multi-line .<strong>subckt</strong> subcircuit definition. For example, some MOSFETs may be described by a .model statement in which case their Spice Prefix is <strong>M</strong> but many MOSFETs are described by a .subckt and so their Spice Prefix is <strong>X</strong>.</p>
<p>Therefore, irrespective of the PCB Prefix chosen for a schematic symbol, the Spice Prefix for a schematic symbol representing a given circuit element must match the type of model required to simulate that instance of that circuit element in your schematic.</p>
<p>For example, if you have two different n-channel MOSFETs in a schematic; Q1, a BSS123 which is modelled by a .model statement:</p>
<p>BSS123*SRC=BSS123;DI_BSS123;MOSFETs N;Enh;100V 0.170A 1.00ohms  Diodes Inc.</p>
<p>MOSFET</p>
<pre><code>.MODEL DI_BSS123  NMOS( LEVEL=1 VTO=1.00 KP=6.37m  GAMMA=1.24
+ PHI=.75  LAMBDA=625u RD=0.140 RS=0.140
+ IS=85.0f  PB=0.800 MJ=0.460 CBD=19.8p
+ CBS=23.7p  CGSO=36.0n CGDO=30.0n CGBO=124n  )
*   -- Assumes default L=100U W=100U --
and Q2, a BSS127S which is modelled by a .subckt:
BSS127S*---------- BSS127S Spice Model ----------
.SUBCKT BSS127S 10 20 30
*     TERMINALS:  D  G  S
M1 1 2 3 3 NMOS L = 1E-006 W = 1E-006
RD 10 1 84.22
RS 30 3 0.001
RG 20 2 29
CGS 2 3 1.958E-011
EGD 12 0 2 1 1
VFB 14 0 0
FFB 2 1 VFB 1
CGD 13 14 2E-011
R1 13 0 1
D1 12 13 DLIM
DDG 15 14 DCGD
R2 12 15 1
D2 15 0 DLIM
DSD 3 10 DSUB
.MODEL NMOS NMOS LEVEL = 3 VMAX = 8E+005 ETA = 1E-012 VTO = 3.419
+ TOX = 6E-008 NSUB = 1E+016 KP = 0.127 U0 = 400 KAPPA = 1.044E-015
.MODEL DCGD D CJO = 1.135E-011 VJ = 0.9232 M = 0.9816
.MODEL DSUB D IS = 2.294E-010 N = 1.601 RS = 0.1079 BV = 65
+ CJO = 1.956E-011 VJ = 1.514 M = 0.8171
.MODEL DLIM D IS = 0.0001
.ENDS
*Diodes BSS127S Spice Model v1.0 Last Revised 2012/6/6
</code></pre>
<p>then even though both have the same PCB Prefix of <strong>Q</strong>: Q1 must have a Spice Prefix of M and <strong>Q2</strong> must have a Spice Prefix of <strong>X</strong>.</p>
<p>A list of Spice Prefixes and their associated circuit elements is given in the table below.
<img src="images/SpicePrefix.png" alt="" /></p>
<p>For more information on circuit elements in Ngspice, please refer to:</p>
<p><a href="http://ngspice.sourceforge.net/docs/ngspice-manual.pdf#subsection.2.1.2">http://ngspice.sourceforge.net/docs/ngspice-manual.pdf#subsection.2.1.2</a></p>
<h2>PCB and Spice pin numbers</h2>
<p>The two sets of pin numbers are:</p>
<ul>
<li>
<p>PCB pin number: these are the numbers for the real, physical device pins in its package. They are required so that the pins of a device symbol in a schematic can be mapped onto the physical pins of a PCB footprint. In other words, so that the connections shown in the schematic, end up connected properly by copper on the PCB.</p>
</li>
<li>
<p>Spice pin number or pin order:  these are the numbers that map the pins on the symbol to their respective functions in the spice model or subcircuit.</p>
</li>
</ul>
<p>Actually the spice pin ordering has a slightly deeper meaning.</p>
<p>Spice has no concept of component symbols: they are a construct of the schematic editor.</p>
<p>When a spice netlist is generated, the symbol in the schematic editor is either - in the case of model defined devices such as resistors, capacitors, inductors, diodes, transistors and sources - mapped directly to the relevant models (defined by the device prefix such as R, C, L, D, Q and so on), or in the case of a subcircuit, converted into a subcircuit call statement.</p>
<p>The spice pin ordering for the majority of built-in models such as resistors, capacitors, inductors, diodes, transistors and sources are defined and generally taken care of by the schematic editor, more care has to be taken with the spice pin ordering of subcircuits.</p>
<p>This can be illustrated by a simple opamp with 5 pins: inverting and non-inverting inputs; output and positive and negative supply pins but the principle applies to all spice subcircuits.</p>
<p>The subcircuit call for this opamp might look like this in the spice netlist:</p>
<p>X1 input feedback vpos vneg output opamp_ANF01</p>
<p>where:</p>
<p>X1 is the name of the subcircuit in the top level (i.e. the calling) circuit;</p>
<p>input feedback vpos vneg output are the netnames in the circuit calling (i.e. containing) the subcircuit and</p>
<p>opamp_ANF01 is the name of the subcircuit being called.</p>
<p>Pay special attention to the order of the netnames in the subcircuit call.</p>
<p>The spice pin ordering for the majority of opamp subcircuits is like that shown</p>
<p>in the example below:</p>
<pre><code>*-------------------------------------------------------------------

*

* opamp_ANF01

*

* Simplified behavioural opamp

*

* Node assignments

*                    noninverting input

*                    |   inverting input  

*                    |   |   positive supply

*                    |   |   |   negative supply

*                    |   |   |   |   output

*                    |   |   |   |   |

* spice pin order:   1   2   3   4   5

*                    |   |   |   |   |

.subckt opamp_ANF01 inp inn vcc vee out ; these are the netnames

*                                         used internally to the

*                                         subcircuit.

B1 out 0

+ V=(TANH((V(inp)-V(inn))*{Avol}*2/(V(vcc)-V(vee)))*(V(vcc)-V(vee))

+ +(V(vcc)+V(vee)))/2

*

.ends opamp_ANF01

*
</code></pre>
<p>Note that the spice pin order of the subcircuit call is in exactly the same order as that of the subcircuit.</p>
<p>Although the physical pin numbering of any device is critical for successfully mapping the pins on a schematic symbol onto a physical package footprint when laying out the PCB, because spice only knows about single devices and does not care about how they are physically packaged, each instance of any device in a spice schematic has to be mapped onto its own copy of the spice model or subcircuit, irrespective of where it is in any physical package.</p>
<p>Therefore, for the physical, package pin numbering of the four opamps in a quad opamp in say, a <strong>SOIC14</strong> or a <strong>DIP14</strong> package, as shown below, to work with the example subcircuit above, the spice pin ordering would be:</p>
<hr />
<pre><code>Opamp A         pin number         spice pin order

OUT                1                5

IN-                2                2

IN+                3                1

V+                4                3

V-                11                4

Opamp B         pin number         spice pin order

OUT                7                5

IN-                6                2

IN+                5                1

V+                4                3

V-                11                4

Opamp C         pin number         spice pin order

OUT                8                5

IN-                9                2

IN+                10                1

V+                4                3

V-                11                4

Opamp D         pin number         spice pin order

OUT                14                5

IN-                13                2

IN+                12                1

V+                4                3

V-                11                4
</code></pre>
<p></p>
<p>The physical package pin numbering reflects that of each opamp in the package.</p>
<p>The spice pin ordering is the same for each instance of the individual opamps.</p>
<p>Of course there is only one physical instance of each supply pin on the schematic symbol for the quad opamp in this example but each spice subcircuit must have the supply pins explicitly defined.</p>
<p>Exactly how this is handled is at the schematic symbol level depends on how the schematic capture package handles symbols for multiple devices with shared supply pins but the generation of a spice netlist from the schematic will always generate the complete set of pins required in the subcircuit calls.</p>
<p>In cases where the subcircuit is built by the user  as opposed to where it is supplied by a vendor for a particular device, exactly the same rules apply except that it is up to the user to specify the subcircuit pin order and to construct the symbol appropriately.</p>
<p>Although as described earlier, built in spice models usually have defined spice pin orders, not all  subcircuits have the same spice pin numbering. Therefore if your spice circuit throws errors - especially if there are warnings about pin numbers or pin names - it is worth remembering to check that the pin order of the symbol that is netlisted to form the calling statement matches that of the subcircuit that is being called!</p>
<hr />
<p><a href="#ftnt_ref8">[8]</a> In Debian based distributions gerbv is listed under Electronics in the package management system. The version in the repositories may be an earlier version but some users may find it easier to install than the sourceforge archive.</p>
<p><a href="#ftnt_ref9">[9]</a> As is the opamp_ANF01 example above</p>

  </article>
</div>
<script>
// FROM http://purecss.io/js/ui.js
(function (window, document) {

  var layout   = document.getElementById('layout'),
  menu     = document.getElementById('menu'),
  menuLink = document.getElementById('menuLink');

  function toggleClass(element, className) {
    var classes = element.className.split(/\s+/),
    length = classes.length,
    i = 0;

    for(; i < length; i++) {
      if (classes[i] === className) {
	classes.splice(i, 1);
	break;
      }
    }
    // The className is not found
    if (length === classes.length) {
      classes.push(className);
    }

    element.className = classes.join(' ');
  }

  menuLink.onclick = function (e) {
    var active = 'active';

    e.preventDefault();
    toggleClass(layout, active);
    toggleClass(menu, active);
    toggleClass(menuLink, active);
  };

}(this, this.document));
</script>
</body>
</html>
